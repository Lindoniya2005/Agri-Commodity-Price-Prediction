<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Agri-Horticultural Price Prediction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .top-bar {
      background-color: #f200e2;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ccc;
    }

    .top-bar a {            
      
      text-decoration: none;
      color: #007BFF;
      font-weight: bold;
    }

    body {
      background-size: cover;
      background-attachment: fixed;
      background-repeat: no-repeat;
      font-family: 'Segoe UI', sans-serif;
      color: #333;
    }

    .card {
      border-radius: 16px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      max-width: 1100px;
      height: 600px;
      margin: 0 auto;
      overflow-y: auto;
      background-color: rgba(255, 255, 255, 0.95);
    }

    .dark-mode {
      background: linear-gradient(145deg, #1a1a2e, #16213e);
      color: #f0f0f0;
    }

    .dark-mode .card {
      background-color: rgba(51, 65, 85, 0.95);
      color: #f0f0f0;
    }

    .dark-mode select,
    .dark-mode input,
    .dark-mode button {
      background-color: #475569;
      color: #f8fafc;
    }

    #priceResult {
      font-weight: bold;
      font-size: 1.2rem;
      text-align: center;
    }

    #predictedValue {
      font-size: 2rem;
      display: inline-block;
    }

  </style>
</head>

<body style="background-color:rgb(0, 183, 255);">
  <div class="top-bar">
    {% if session['username'] %}
   <h4>   <span>ğŸ‘¤ Welcome, {{ session['username'] }}</span></h4>
    <h4> <a href="{{ url_for('logout') }}">ğŸ”“ Logout</a></h4>
    {% endif %}
  </div>
  <div class="container my-4">
    <div class="d-flex justify-content-end mb-3">
      <button onclick="toggleDarkMode()" class="btn btn-sm btn-outline-dark me-2">ğŸŒ— Toggle Dark Mode</button>
      <select onchange="changeLang(this.value)" class="form-select w-auto" id="language">
        <option value="en">English</option>
        <option value="ta">à®¤à®®à®¿à®´à¯</option>
        <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€</option>
      </select>
    </div>

    <div class="card p-4">
      <h2 class="text-center mb-4" data-en="ğŸŒ¾ Agri-Horticultural Price Prediction ğŸŒ¾" data-ta="ğŸŒ¾ à®µà¯‡à®³à®¾à®£à¯-à®¤à¯‹à®Ÿà¯à®Ÿà®•à¯à®•à®²à¯ˆ à®µà®¿à®²à¯ˆ à®•à®£à®¿à®ªà¯à®ªà®¾à®©à¯ ğŸŒ¾" data-hi="ğŸŒ¾ à¤•à¥ƒà¤·à¤¿-à¤‰à¤¦à¥à¤¯à¤¾à¤¨ à¤®à¥‚à¤²à¥à¤¯ à¤ªà¥‚à¤°à¥à¤µà¤¾à¤¨à¥à¤®à¤¾à¤¨ ğŸŒ¾">
        ğŸŒ¾ Agri-Horticultural Price Prediction ğŸŒ¾
      </h2>

      <!-- Prediction Form -->
      <form id="predictionForm" onsubmit="return false;">
        <div class="mb-3">
          <label class="form-label lang" data-en="Select Commodity:" data-ta="à®¤à®¾à®©à®¿à®¯à®®à¯ à®¤à¯‡à®°à¯à®µà¯ à®šà¯†à®¯à¯à®•:" data-hi="à¤•à¥ƒà¤·à¤¿ à¤‰à¤¤à¥à¤ªà¤¾à¤¦ à¤šà¥à¤¨à¥‡à¤‚:">Select Commodity:</label>
          <select id="commodity" class="form-select">
            <option value="Onion">ğŸ§… <span class="translate" data-en="Onion" data-ta="à®µà¯†à®™à¯à®•à®¾à®¯à®®à¯" data-hi="à¤ªà¥à¤¯à¤¾à¤œ">Onion</span></option>
            <option value="Potato">ğŸ¥” <span class="translate" data-en="Potato" data-ta="à®‰à®°à¯à®³à¯ˆà®•à¯à®•à®¿à®´à®™à¯à®•à¯" data-hi="à¤†à¤²à¥‚">Potato</span></option>
            <option value="Pulses">ğŸŒ± <span class="translate" data-en="Pulses" data-ta="à®¤à®¾à®©à®¿à®¯à®™à¯à®•à®³à¯" data-hi="à¤¦à¤¾à¤²à¥‡à¤‚">Pulses</span></option>
            <option value="Tomato">ğŸ… <span class="translate" data-en="Tomato" data-ta="à®¤à®•à¯à®•à®¾à®³à®¿" data-hi="à¤Ÿà¤®à¤¾à¤Ÿà¤°">Tomato</span></option>
            <option value="Rice">ğŸš <span class="translate" data-en="Rice" data-ta="à®…à®°à®¿à®šà®¿" data-hi="à¤šà¤¾à¤µà¤²">Rice</span></option>
            <option value="Wheat">ğŸŒ¾ <span class="translate" data-en="Wheat" data-ta="à®•à¯‹à®¤à¯à®®à¯ˆ" data-hi="à¤—à¥‡à¤¹à¥‚à¤‚">Wheat</span></option>
            <option value="Sugar">ğŸ¬ <span class="translate" data-en="Sugar" data-ta="à®šà®°à¯à®•à¯à®•à®°à¯ˆ" data-hi="à¤šà¥€à¤¨à¥€">Sugar</span></option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label lang" data-en="Temperature (Â°C):" data-ta="à®µà¯†à®ªà¯à®ªà®¨à®¿à®²à¯ˆ (Â°C):" data-hi="à¤¤à¤¾à¤ªà¤®à¤¾à¤¨ (Â°C):">ğŸŒ¡ï¸Temperature (Â°C):</label>
          <input type="number" id="temperature" class="form-control" value="31" step="0.1">
        </div>
        <div class="mb-3">
          <label class="form-label lang" 
                 data-en="â˜” Rainfall (cm):" 
                 data-ta="â˜” à®®à®´à¯ˆ (à®šà¯†.à®®à¯€):" 
                 data-hi="â˜” à¤µà¤°à¥à¤·à¤¾ (à¤¸à¥‡.à¤®à¥€):">
          </label>
          <input type="number" id="rainfall" class="form-control" value="5.0" step="0.1">
        </div>
        
        <div class="mb-3">
          <label class="form-label lang" data-en="Predicted Yield (acre):" data-ta="à®®à¯à®©à¯à®©à®±à®¿à®¯à®ªà¯à®ªà®Ÿà¯à®Ÿ à®µà®¿à®³à¯ˆà®šà¯à®šà®²à¯ (à®à®•à¯à®•à®°à¯):" data-hi="à¤ªà¥‚à¤°à¥à¤µà¤¾à¤¨à¥à¤®à¤¾à¤¨ à¤‰à¤ªà¤œ (à¤à¤•à¤¡à¤¼):">ğŸŒ¾Predicted Yield (tons/acre):</label>
          <input type="number" id="userYield" class="form-control" value="7" step="0.1">
        </div>
        <button type="button" class="btn btn-primary w-100 lang" onclick="predictPrice()" data-en="ğŸ” Predict Price" data-ta="ğŸ” à®µà®¿à®²à¯ˆ à®•à®£à®¿à®•à¯à®•à®µà¯à®®à¯" data-hi="ğŸ” à¤•à¥€à¤®à¤¤ à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤²à¤—à¤¾à¤à¤‚">ğŸ” Predict Price</button>
      </form>

      <!-- Results Section -->
      <div id="result" class="mt-4" style="display: none;">
        <div class="alert alert-info text-center mt-4" style="font-size: 1.3rem;">
          <p><strong>ğŸ“Œ Commodity:</strong> <span id="selectedCommodity"></span> &nbsp;&nbsp; <strong>ğŸŒ¡ï¸Temperature:</strong> <span id="selectedTemperature"></span> Â°C &nbsp;&nbsp; <strong>â˜” Rainfall:</strong> <span id="selectedRainfall"></span> cm</p>
          <p style="font-size: 1.8rem;"><strong>ğŸ’° Price:</strong> â‚¹<span id="predictedValue"></span></p>
          <p style="font-size: 1.5rem;"><strong>ğŸŒ¾ Predicted Yield:</strong> <span id="predictedYield"></span> acre</p>
        </div>
        <canvas id="priceChart" height="100"></canvas>
      </div>
    </div>
  </div>

  <script>
    // Dark mode toggle function
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    // Language change function
    function changeLang(lang) {
      document.querySelectorAll('[data-' + lang + ']').forEach(el => {
        const newText = el.getAttribute('data-' + lang);
        if (newText) el.innerText = newText;
      });
    }

    // Prediction function
    function predictPrice() {
      const temp = parseFloat(document.getElementById('temperature').value);
      const rain = parseFloat(document.getElementById('rainfall').value);
      const commodity = document.getElementById('commodity').value;
      const userYield = parseFloat(document.getElementById('userYield').value);
      
      const basePrices = {
        'Onion': 12,
        'Potato': 10,
        'Pulses': 50,
        'Tomato': 14,
        'Rice': 25,
        'Wheat': 22,
        'Sugar': 20
      };

      // Calculate predicted price
      const base = basePrices[commodity] || 20;
      const predictedPrice = (base + temp * 0.1 + rain * 0.2 + userYield * 0.3).toFixed(2);
      const predictedYield = (userYield).toFixed(2);

      document.getElementById('selectedCommodity').innerText = commodity;
      document.getElementById('selectedTemperature').innerText = temp;
      document.getElementById('selectedRainfall').innerText = rain;
      document.getElementById('predictedValue').innerText = predictedPrice;
      document.getElementById('predictedYield').innerText = predictedYield;
      document.getElementById('result').style.display = 'block';

      // Generate price chart
      const ctx = document.getElementById('priceChart').getContext('2d');
      if (window.myChart) window.myChart.destroy();
      window.myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Prediction'],
          datasets: [{
            label: 'Price (â‚¹)',
            data: [14, 15, 17, 18, predictedPrice],
            borderColor: 'rgba(34, 197, 94, 1)',
            backgroundColor: 'rgba(34, 197, 94, 0.1)',
            tension: 0.4,
            fill: true,
            pointBackgroundColor: '#22c55e',
          }]
        },
        options: {
          responsive: true
        }
      });

      document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
